---
title: "献立生成"
api: "POST /v1/meal-plans/generate"
description: "AIを使用して新しい献立を生成します"
---

## 概要

このエンドポイントは、家族プロフィールと指定された条件に基づいて、AIが最適な献立を自動生成します。栄養バランス、アレルギー情報、食材の好みなどを考慮した献立が数秒で作成されます。

## エンドポイント

```
POST https://api.mealplan-ai.com/v1/meal-plans/generate
```

## 認証

<ParamField header="Authorization" type="string" required>
  Bearer トークン形式のAPIキーまたはOAuthアクセストークン
  
  例: `Bearer your_api_key_here`
</ParamField>

## リクエストボディ

<ParamField body="duration_days" type="integer" required>
  献立を生成する日数（1〜30）
  
  例: `7` (1週間分)
</ParamField>

<ParamField body="start_date" type="string">
  献立の開始日（ISO 8601形式）。指定しない場合は今日から開始
  
  例: `"2024-01-15"`
</ParamField>

<ParamField body="preferences" type="object">
  献立生成の詳細な設定
  
  <Expandable title="preferences のプロパティ">
    <ParamField body="preferences.cuisine_types" type="array">
      希望する料理のジャンル
      
      選択肢: `japanese`, `western`, `chinese`, `italian`, `french`, `korean`, `thai`, `indian`, `mexican`
      
      例: `["japanese", "western"]`
    </ParamField>
    
    <ParamField body="preferences.max_cooking_time" type="integer">
      最大調理時間（分）
      
      例: `45`
    </ParamField>
    
    <ParamField body="preferences.difficulty_level" type="string">
      料理の難易度
      
      選択肢: `easy`, `medium`, `hard`
      
      デフォルト: `medium`
    </ParamField>
    
    <ParamField body="preferences.budget_per_meal" type="integer">
      1食あたりの予算（円）
      
      例: `500`
    </ParamField>
    
    <ParamField body="preferences.avoid_ingredients" type="array">
      避けたい食材のリスト
      
      例: `["えび", "かに", "ピーナッツ"]`
    </ParamField>
    
    <ParamField body="preferences.preferred_ingredients" type="array">
      優先的に使用したい食材
      
      例: `["鶏肉", "豆腐", "ブロッコリー"]`
    </ParamField>
    
    <ParamField body="preferences.meal_types" type="object">
      各食事タイプの設定
      
      <Expandable title="meal_types のプロパティ">
        <ParamField body="preferences.meal_types.breakfast" type="boolean">
          朝食を含めるか（デフォルト: `true`）
        </ParamField>
        
        <ParamField body="preferences.meal_types.lunch" type="boolean">
          昼食を含めるか（デフォルト: `true`）
        </ParamField>
        
        <ParamField body="preferences.meal_types.dinner" type="boolean">
          夕食を含めるか（デフォルト: `true`）
        </ParamField>
        
        <ParamField body="preferences.meal_types.snack" type="boolean">
          間食を含めるか（デフォルト: `false`）
        </ParamField>
      </Expandable>
    </ParamField>
    
    <ParamField body="preferences.nutrition_goals" type="object">
      栄養目標の設定
      
      <Expandable title="nutrition_goals のプロパティ">
        <ParamField body="preferences.nutrition_goals.target_calories" type="integer">
          1日の目標カロリー（kcal）
        </ParamField>
        
        <ParamField body="preferences.nutrition_goals.protein_ratio" type="number">
          タンパク質の割合（0.0〜1.0）
        </ParamField>
        
        <ParamField body="preferences.nutrition_goals.carb_ratio" type="number">
          炭水化物の割合（0.0〜1.0）
        </ParamField>
        
        <ParamField body="preferences.nutrition_goals.fat_ratio" type="number">
          脂質の割合（0.0〜1.0）
        </ParamField>
      </Expandable>
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="profile_id" type="string">
  使用する家族プロフィールのID。指定しない場合はデフォルトプロフィールを使用
  
  例: `"prof_abc123"`
</ParamField>

<ParamField body="generate_shopping_list" type="boolean">
  買い物リストを同時に生成するか
  
  デフォルト: `true`
</ParamField>

## リクエスト例

<CodeGroup>
```bash cURL
curl -X POST https://api.mealplan-ai.com/v1/meal-plans/generate \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "duration_days": 7,
    "start_date": "2024-01-15",
    "preferences": {
      "cuisine_types": ["japanese", "western"],
      "max_cooking_time": 45,
      "difficulty_level": "medium",
      "budget_per_meal": 500,
      "meal_types": {
        "breakfast": true,
        "lunch": true,
        "dinner": true,
        "snack": false
      },
      "nutrition_goals": {
        "target_calories": 2000,
        "protein_ratio": 0.3,
        "carb_ratio": 0.5,
        "fat_ratio": 0.2
      }
    },
    "generate_shopping_list": true
  }'
```

```javascript JavaScript
const response = await fetch('https://api.mealplan-ai.com/v1/meal-plans/generate', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    duration_days: 7,
    start_date: '2024-01-15',
    preferences: {
      cuisine_types: ['japanese', 'western'],
      max_cooking_time: 45,
      difficulty_level: 'medium',
      budget_per_meal: 500,
      meal_types: {
        breakfast: true,
        lunch: true,
        dinner: true,
        snack: false
      },
      nutrition_goals: {
        target_calories: 2000,
        protein_ratio: 0.3,
        carb_ratio: 0.5,
        fat_ratio: 0.2
      }
    },
    generate_shopping_list: true
  })
});

const mealPlan = await response.json();
console.log(mealPlan);
```

```python Python
import requests

url = "https://api.mealplan-ai.com/v1/meal-plans/generate"
headers = {
    "Authorization": "Bearer YOUR_API_KEY",
    "Content-Type": "application/json"
}
data = {
    "duration_days": 7,
    "start_date": "2024-01-15",
    "preferences": {
        "cuisine_types": ["japanese", "western"],
        "max_cooking_time": 45,
        "difficulty_level": "medium",
        "budget_per_meal": 500,
        "meal_types": {
            "breakfast": True,
            "lunch": True,
            "dinner": True,
            "snack": False
        },
        "nutrition_goals": {
            "target_calories": 2000,
            "protein_ratio": 0.3,
            "carb_ratio": 0.5,
            "fat_ratio": 0.2
        }
    },
    "generate_shopping_list": True
}

response = requests.post(url, headers=headers, json=data)
meal_plan = response.json()
print(meal_plan)
```

```ruby Ruby
require 'net/http'
require 'json'

uri = URI('https://api.mealplan-ai.com/v1/meal-plans/generate')
request = Net::HTTP::Post.new(uri)
request['Authorization'] = 'Bearer YOUR_API_KEY'
request['Content-Type'] = 'application/json'
request.body = {
  duration_days: 7,
  start_date: '2024-01-15',
  preferences: {
    cuisine_types: ['japanese', 'western'],
    max_cooking_time: 45,
    difficulty_level: 'medium',
    budget_per_meal: 500,
    meal_types: {
      breakfast: true,
      lunch: true,
      dinner: true,
      snack: false
    },
    nutrition_goals: {
      target_calories: 2000,
      protein_ratio: 0.3,
      carb_ratio: 0.5,
      fat_ratio: 0.2
    }
  },
  generate_shopping_list: true
}.to_json

response = Net::HTTP.start(uri.hostname, uri.port, use_ssl: true) do |http|
  http.request(request)
end

meal_plan = JSON.parse(response.body)
puts meal_plan
```
</CodeGroup>

## レスポンス

<ResponseField name="success" type="boolean">
  リクエストが成功したかどうか
</ResponseField>

<ResponseField name="data" type="object">
  生成された献立データ
  
  <Expandable title="data のプロパティ">
    <ResponseField name="data.id" type="string">
      献立のユニークID
      
      例: `"mp_abc123"`
    </ResponseField>
    
    <ResponseField name="data.duration_days" type="integer">
      献立の日数
    </ResponseField>
    
    <ResponseField name="data.start_date" type="string">
      献立の開始日
    </ResponseField>
    
    <ResponseField name="data.end_date" type="string">
      献立の終了日
    </ResponseField>
    
    <ResponseField name="data.created_at" type="string">
      作成日時（ISO 8601形式）
    </ResponseField>
    
    <ResponseField name="data.meals" type="array">
      日ごとの食事データの配列
      
      <Expandable title="meals の要素">
        <ResponseField name="meals[].date" type="string">
          日付
        </ResponseField>
        
        <ResponseField name="meals[].breakfast" type="object">
          朝食の詳細
          
          <Expandable title="breakfast のプロパティ">
            <ResponseField name="breakfast.recipe_id" type="string">
              レシピID
            </ResponseField>
            
            <ResponseField name="breakfast.name" type="string">
              料理名
            </ResponseField>
            
            <ResponseField name="breakfast.cooking_time" type="integer">
              調理時間（分）
            </ResponseField>
            
            <ResponseField name="breakfast.difficulty" type="string">
              難易度
            </ResponseField>
            
            <ResponseField name="breakfast.calories" type="integer">
              カロリー（kcal）
            </ResponseField>
            
            <ResponseField name="breakfast.nutrition" type="object">
              栄養情報
            </ResponseField>
            
            <ResponseField name="breakfast.ingredients" type="array">
              材料リスト
            </ResponseField>
          </Expandable>
        </ResponseField>
        
        <ResponseField name="meals[].lunch" type="object">
          昼食の詳細（構造はbreakfastと同じ）
        </ResponseField>
        
        <ResponseField name="meals[].dinner" type="object">
          夕食の詳細（構造はbreakfastと同じ）
        </ResponseField>
        
        <ResponseField name="meals[].daily_nutrition" type="object">
          1日の栄養合計
        </ResponseField>
      </Expandable>
    </ResponseField>
    
    <ResponseField name="data.nutrition_summary" type="object">
      期間全体の栄養サマリー
      
      <Expandable title="nutrition_summary のプロパティ">
        <ResponseField name="nutrition_summary.total_calories" type="integer">
          総カロリー
        </ResponseField>
        
        <ResponseField name="nutrition_summary.avg_daily_calories" type="integer">
          1日平均カロリー
        </ResponseField>
        
        <ResponseField name="nutrition_summary.protein" type="number">
          タンパク質（g）
        </ResponseField>
        
        <ResponseField name="nutrition_summary.carbohydrates" type="number">
          炭水化物（g）
        </ResponseField>
        
        <ResponseField name="nutrition_summary.fat" type="number">
          脂質（g）
        </ResponseField>
      </Expandable>
    </ResponseField>
    
    <ResponseField name="data.shopping_list_id" type="string">
      生成された買い物リストのID（generate_shopping_list=trueの場合）
    </ResponseField>
    
    <ResponseField name="data.profile_id" type="string">
      使用された家族プロフィールのID
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="meta" type="object">
  メタデータ
  
  <Expandable title="meta のプロパティ">
    <ResponseField name="meta.request_id" type="string">
      リクエストID
    </ResponseField>
    
    <ResponseField name="meta.timestamp" type="string">
      タイムスタンプ
    </ResponseField>
    
    <ResponseField name="meta.generation_time" type="number">
      生成にかかった時間（秒）
    </ResponseField>
  </Expandable>
</ResponseField>

## レスポンス例

```json
{
  "success": true,
  "data": {
    "id": "mp_abc123",
    "duration_days": 7,
    "start_date": "2024-01-15",
    "end_date": "2024-01-21",
    "created_at": "2024-01-15T10:30:00Z",
    "meals": [
      {
        "date": "2024-01-15",
        "breakfast": {
          "recipe_id": "rec_001",
          "name": "和風オムレツ",
          "cooking_time": 15,
          "difficulty": "easy",
          "calories": 320,
          "nutrition": {
            "protein": 18,
            "carbohydrates": 12,
            "fat": 22
          },
          "ingredients": [
            {"name": "卵", "amount": "2個", "unit": "個"},
            {"name": "ほうれん草", "amount": "50g", "unit": "g"},
            {"name": "醤油", "amount": "小さじ1", "unit": "小さじ"}
          ]
        },
        "lunch": {
          "recipe_id": "rec_002",
          "name": "鶏肉の照り焼き丼",
          "cooking_time": 25,
          "difficulty": "medium",
          "calories": 580,
          "nutrition": {
            "protein": 35,
            "carbohydrates": 65,
            "fat": 15
          },
          "ingredients": [
            {"name": "鶏もも肉", "amount": "150g", "unit": "g"},
            {"name": "ご飯", "amount": "200g", "unit": "g"},
            {"name": "醤油", "amount": "大さじ2", "unit": "大さじ"}
          ]
        },
        "dinner": {
          "recipe_id": "rec_003",
          "name": "サーモンのムニエル",
          "cooking_time": 30,
          "difficulty": "medium",
          "calories": 450,
          "nutrition": {
            "protein": 32,
            "carbohydrates": 20,
            "fat": 28
          },
          "ingredients": [
            {"name": "サーモン", "amount": "150g", "unit": "g"},
            {"name": "バター", "amount": "10g", "unit": "g"},
            {"name": "レモン", "amount": "1/4個", "unit": "個"}
          ]
        },
        "daily_nutrition": {
          "total_calories": 1350,
          "protein": 85,
          "carbohydrates": 97,
          "fat": 65
        }
      }
    ],
    "nutrition_summary": {
      "total_calories": 9450,
      "avg_daily_calories": 1350,
      "protein": 595,
      "carbohydrates": 679,
      "fat": 455
    },
    "shopping_list_id": "sl_xyz789",
    "profile_id": "prof_default"
  },
  "meta": {
    "request_id": "req_abc123",
    "timestamp": "2024-01-15T10:30:00Z",
    "generation_time": 3.2
  }
}
```

## エラーレスポンス

<ResponseField name="error" type="object">
  エラー情報
  
  <Expandable title="error のプロパティ">
    <ResponseField name="error.code" type="string">
      エラーコード
    </ResponseField>
    
    <ResponseField name="error.message" type="string">
      エラーメッセージ
    </ResponseField>
    
    <ResponseField name="error.details" type="object">
      エラーの詳細情報
    </ResponseField>
  </Expandable>
</ResponseField>

### エラーコード一覧

| コード | 説明 |
|--------|------|
| `invalid_duration` | duration_daysが範囲外（1〜30） |
| `invalid_date` | start_dateの形式が不正 |
| `profile_not_found` | 指定されたプロフィールが見つからない |
| `insufficient_data` | プロフィール情報が不足している |
| `generation_failed` | 献立生成に失敗した |
| `rate_limit_exceeded` | レート制限を超過 |

### エラーレスポンス例

```json
{
  "success": false,
  "error": {
    "code": "invalid_duration",
    "message": "duration_daysは1以上30以下である必要があります",
    "details": {
      "field": "duration_days",
      "value": 45,
      "min": 1,
      "max": 30
    }
  },
  "meta": {
    "request_id": "req_xyz789",
    "timestamp": "2024-01-15T10:30:00Z"
  }
}
```

## 使用例とユースケース

### 基本的な1週間の献立生成

```javascript
const mealPlan = await fetch('https://api.mealplan-ai.com/v1/meal-plans/generate', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    duration_days: 7
  })
}).then(res => res.json());

console.log(`献立ID: ${mealPlan.data.id}`);
console.log(`買い物リストID: ${mealPlan.data.shopping_list_id}`);
```

### 時短レシピ中心の献立

```javascript
const quickMealPlan = await fetch('https://api.mealplan-ai.com/v1/meal-plans/generate', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    duration_days: 5,
    preferences: {
      max_cooking_time: 30,
      difficulty_level: 'easy'
    }
  })
}).then(res => res.json());
```

### ダイエット向け低カロリー献立

```javascript
const dietMealPlan = await fetch('https://api.mealplan-ai.com/v1/meal-plans/generate', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    duration_days: 7,
    preferences: {
      nutrition_goals: {
        target_calories: 1500,
        protein_ratio: 0.35,
        carb_ratio: 0.40,
        fat_ratio: 0.25
      },
      preferred_ingredients: ['鶏むね肉', '豆腐', 'ブロッコリー', 'キャベツ']
    }
  })
}).then(res => res.json());
```

## 注意事項

<Warning>
  献立生成には通常3〜5秒かかります。タイムアウトは30秒に設定してください。
</Warning>

<Tip>
  より正確な献立を生成するために、家族プロフィールを事前に詳しく設定することをお勧めします。
</Tip>

<Note>
  生成された献立は、[献立更新API](/api-reference/meal-plans/update)を使用して後から編集できます。
</Note>

## 関連エンドポイント

<CardGroup cols={2}>
  <Card title="献立一覧取得" icon="list" href="/api-reference/meal-plans/list">
    過去に生成した献立の一覧を取得
  </Card>
  <Card title="献立詳細取得" icon="file" href="/api-reference/meal-plans/get">
    特定の献立の詳細情報を取得
  </Card>
  <Card title="買い物リスト取得" icon="cart-shopping" href="/api-reference/shopping/get">
    生成された買い物リストを取得
  </Card>
  <Card title="プロフィール管理" icon="user" href="/api-reference/profiles/get">
    家族プロフィールを管理
  </Card>
</CardGroup>