---
title: "献立更新"
api: "PUT /v1/meal-plans/{id}"
description: "既存の献立を更新します"
---

## 概要

このエンドポイントは、既存の献立の内容を更新します。特定の日の食事を変更したり、レシピを入れ替えたりできます。

## エンドポイント

```
PUT https://api.mealplan-ai.com/v1/meal-plans/{id}
```

## 認証

<ParamField header="Authorization" type="string" required>
  Bearer トークン形式のAPIキーまたはOAuthアクセストークン
</ParamField>

## パスパラメータ

<ParamField path="id" type="string" required>
  更新する献立のID
  
  例: `mp_abc123`
</ParamField>

## リクエストボディ

<ParamField body="meals" type="array">
  更新する食事データの配列。指定した日付の食事のみが更新されます
  
  <Expandable title="meals の要素">
    <ParamField body="meals[].date" type="string" required>
      更新する日付
    </ParamField>
    
    <ParamField body="meals[].breakfast" type="object">
      朝食の更新（指定した場合のみ更新）
      
      <Expandable title="breakfast のプロパティ">
        <ParamField body="breakfast.recipe_id" type="string">
          新しいレシピID
        </ParamField>
      </Expandable>
    </ParamField>
    
    <ParamField body="meals[].lunch" type="object">
      昼食の更新
    </ParamField>
    
    <ParamField body="meals[].dinner" type="object">
      夕食の更新
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="preferences" type="object">
  献立の設定を更新
</ParamField>

## リクエスト例

<CodeGroup>
```bash cURL
curl -X PUT https://api.mealplan-ai.com/v1/meal-plans/mp_abc123 \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "meals": [
      {
        "date": "2024-01-16",
        "dinner": {
          "recipe_id": "rec_999"
        }
      }
    ]
  }'
```

```javascript JavaScript
const response = await fetch(
  'https://api.mealplan-ai.com/v1/meal-plans/mp_abc123',
  {
    method: 'PUT',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      meals: [
        {
          date: '2024-01-16',
          dinner: {
            recipe_id: 'rec_999'
          }
        }
      ]
    })
  }
);

const updatedMealPlan = await response.json();
console.log(updatedMealPlan);
```

```python Python
import requests

meal_plan_id = "mp_abc123"
url = f"https://api.mealplan-ai.com/v1/meal-plans/{meal_plan_id}"
headers = {
    "Authorization": "Bearer YOUR_API_KEY",
    "Content-Type": "application/json"
}
data = {
    "meals": [
        {
            "date": "2024-01-16",
            "dinner": {
                "recipe_id": "rec_999"
            }
        }
    ]
}

response = requests.put(url, headers=headers, json=data)
updated_meal_plan = response.json()
print(updated_meal_plan)
```
</CodeGroup>

## レスポンス

<ResponseField name="success" type="boolean">
  更新が成功したかどうか
</ResponseField>

<ResponseField name="data" type="object">
  更新後の献立データ（構造は[献立詳細取得](/api-reference/meal-plans/get)と同じ）
</ResponseField>

## レスポンス例

```json
{
  "success": true,
  "data": {
    "id": "mp_abc123",
    "duration_days": 7,
    "start_date": "2024-01-15",
    "end_date": "2024-01-21",
    "updated_at": "2024-01-16T14:20:00Z",
    "meals": [
      {
        "date": "2024-01-16",
        "breakfast": {
          "recipe_id": "rec_001",
          "name": "和風オムレツ"
        },
        "lunch": {
          "recipe_id": "rec_002",
          "name": "鶏肉の照り焼き丼"
        },
        "dinner": {
          "recipe_id": "rec_999",
          "name": "豚肉の生姜焼き"
        }
      }
    ],
    "nutrition_summary": {
      "avg_daily_calories": 1380,
      "protein": 610,
      "carbohydrates": 685,
      "fat": 460
    }
  },
  "meta": {
    "request_id": "req_abc123",
    "timestamp": "2024-01-16T14:20:00Z"
  }
}
```

## 使用例

### 特定の日の夕食を変更

```javascript
async function changeDinner(mealPlanId, date, newRecipeId) {
  const response = await fetch(
    `https://api.mealplan-ai.com/v1/meal-plans/${mealPlanId}`,
    {
      method: 'PUT',
      headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        meals: [
          {
            date: date,
            dinner: {
              recipe_id: newRecipeId
            }
          }
        ]
      })
    }
  );
  
  return await response.json();
}

// 使用例
changeDinner('mp_abc123', '2024-01-16', 'rec_999');
```

### 複数の食事を一度に更新

```javascript
const response = await fetch(
  'https://api.mealplan-ai.com/v1/meal-plans/mp_abc123',
  {
    method: 'PUT',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      meals: [
        {
          date: '2024-01-16',
          lunch: { recipe_id: 'rec_888' },
          dinner: { recipe_id: 'rec_999' }
        },
        {
          date: '2024-01-17',
          breakfast: { recipe_id: 'rec_777' }
        }
      ]
    })
  }
);
```

## エラーレスポンス

### 404 Not Found

```json
{
  "success": false,
  "error": {
    "code": "not_found",
    "message": "指定された献立が見つかりません"
  }
}
```

### 400 Bad Request

```json
{
  "success": false,
  "error": {
    "code": "invalid_recipe",
    "message": "指定されたレシピIDが無効です",
    "details": {
      "recipe_id": "rec_invalid"
    }
  }
}
```

## 注意事項

<Warning>
  更新後、栄養サマリーは自動的に再計算されます。
</Warning>

<Tip>
  買い物リストも自動的に更新されます。変更された食事の材料が反映されます。
</Tip>

## 関連エンドポイント

<CardGroup cols={2}>
  <Card title="献立詳細取得" icon="file" href="/api-reference/meal-plans/get">
    更新前の献立を確認
  </Card>
  <Card title="レシピ検索" icon="magnifying-glass" href="/api-reference/recipes/search">
    入れ替え用のレシピを検索
  </Card>
  <Card title="買い物リスト取得" icon="cart-shopping" href="/api-reference/shopping/get">
    更新後の買い物リストを確認
  </Card>
  <Card title="献立削除" icon="trash" href="/api-reference/meal-plans/delete">
    献立を削除
  </Card>
</CardGroup>